<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Fuga nas Cavernas - O Chamado das Estrelas</title>
  <!-- Fonte e estilos -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;700&display=swap" rel="stylesheet">

  <style>
    /* Reset b√°sico */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* Configura√ß√µes gerais de fonte e cor */
    body {
      font-family: 'Source Code Pro', monospace;
      /* Imagem de fundo fixa e centralizada */
      background: url("./images/cave_background_converted.jpg") no-repeat center center fixed;
      background-size: cover; /* Ajusta a imagem para cobrir toda a √°rea */
      color: #fff;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    /* Container principal semitransparente para destacar o texto */
    .container {
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      width: 100%;
      max-width: 700px;
      border-radius: 8px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
      padding: 30px;
    }

    /* T√≠tulo com cor de destaque */
    h1 {
      font-size: 1.8em;
      text-align: center;
      margin-bottom: 15px;
      color: #ffdd57;
    }

    /* Texto padr√£o */
    p {
      font-size: 1em;
      line-height: 1.6;
      margin: 15px 0;
      text-align: justify;
    }

    /* Bot√µes */
    button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 12px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      background: #5563DE;
      color: #fff;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #3f4ac8;
    }

    /* √Årea de log estilo ‚Äúterminal‚Äù */
    #log {
      background: #001a00;
      color: #0f0;
      padding: 15px;
      height: 200px;
      overflow-y: auto;
      border-radius: 5px;
      border: 1px solid #0f0;
      margin-top: 15px;
      font-size: 0.95em;
      white-space: pre-wrap;
    }

    /* Status e resultado */
    #status {
      margin-top: 15px;
      font-weight: bold;
      text-align: center;
    }
    #resultSection {
      margin-top: 20px;
      display: none;
      text-align: center;
    }
    #resultSection p {
      margin: 10px 0;
    }

    /* Destaque de texto */
    .highlight {
      color: #5563DE;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Fuga nas Cavernas </h1>
  <!-- Bot√£o para iniciar a m√∫sica -->
  <button id="startMusicBtn">üéµ Iniciar M√∫sica</button>

  <p>
    Voc√™ √© <strong>Leon</strong>, um crist√£o devoto que se v√™ preso em um vasto sistema de cavernas ap√≥s nocautear Noah. 
    Agora, precisa usar sua l√≥gica, conhecimentos em inform√°tica e os dados do smartphone para encontrar a √∫nica rota de sa√≠da.
  </p>
  <p>
    Selecione as a√ß√µes abaixo para analisar o ambiente, consultar o celular e escolher seu caminho. 
    Apenas um caminho levar√° √† fuga, conforme as descobertas que voc√™ fizer.
  </p>

<button id="btnAnalyzeCorridors">Analisar Corredores</button>
<button id="btnCheckPhone">Checar Smartphone</button>
<button id="btnSolvePuzzle">Resolver Enigma (Dados de Sat√©lite)</button>
<button id="btnChoosePath">Escolher Rota</button>

<div id="status"></div>
<div id="log"></div>

<div id="resultSection">
  <p id="finalText"></p>
  <button id="restartBtn" onclick="location.reload()">Reiniciar</button>
</div>
</div>

<!-- √Åudio da m√∫sica -->
<audio id="bgMusic" src="risk-136788.mp3" loop></audio>

<script>
  // Estado do jogo
  let corridorsAnalyzed = false;
  let phoneChecked = false;
  let puzzleSolved = false;
  let corridorChoice = false;

  // Refer√™ncias aos elementos do DOM
  const logDiv        = document.getElementById('log');
  const statusDiv     = document.getElementById('status');
  const resultSection = document.getElementById('resultSection');
  const finalText     = document.getElementById('finalText');

  const startMusicBtn        = document.getElementById('startMusicBtn');
  const btnAnalyzeCorridors  = document.getElementById('btnAnalyzeCorridors');
  const btnCheckPhone        = document.getElementById('btnCheckPhone');
  const btnSolvePuzzle       = document.getElementById('btnSolvePuzzle');
  const btnChoosePath        = document.getElementById('btnChoosePath');
  const bgMusic              = document.getElementById('bgMusic');

  // Eventos de clique
  startMusicBtn.addEventListener('click', startMusic);
  btnAnalyzeCorridors.addEventListener('click', analyzeCorridors);
  btnCheckPhone.addEventListener('click', checkPhone);
  btnSolvePuzzle.addEventListener('click', solvePuzzle);
  btnChoosePath.addEventListener('click', choosePath);

  // Inicia a m√∫sica com clique do usu√°rio (evitando bloqueio de autoplay)
  function startMusic() {
    bgMusic.volume = 0.4;
    bgMusic.play().catch(err => {
      appendLog('üîá N√£o foi poss√≠vel iniciar a m√∫sica automaticamente: ' + err);
    });
    startMusicBtn.style.display = 'none';
    appendLog('üéµ M√∫sica iniciada. O ambiente se torna ainda mais tenso...');
  }

  // Adiciona texto ao log e rola para o final
  function appendLog(text) {
    logDiv.textContent += text + '\n';
    logDiv.scrollTop = logDiv.scrollHeight;
  }

  function analyzeCorridors() {
    if (!corridorsAnalyzed) {
      appendLog('Voc√™ ergue a tocha e estuda atentamente a √°rea, reconhecendo quatro corredores:');
      appendLog('- Corredor A: desce gradualmente, com gotejamento intenso (poss√≠vel presen√ßa de √°gua).');
      appendLog('- Corredor B: um leve vento circula, mas o cheiro de mofo permeia; paredes calc√°rias rachadas.');
      appendLog('- Corredor C: obstru√≠do parcialmente por pedras, por√©m o som de ar atr√°s delas sugere passagem.');
      appendLog('- Corredor D: amplo e relativamente seco, com uma brisa morna vinda do interior.');
      corridorsAnalyzed = true;
      statusDiv.textContent = 'Observa√ß√£o dos corredores conclu√≠da.';
    } else {
      appendLog('Voc√™ j√° analisou os corredores. Nada novo no momento.');
    }
  }

  function checkPhone() {
    if (!corridorsAnalyzed) {
      appendLog('√â melhor inspecionar o ambiente antes de usar o celular.');
      statusDiv.textContent = 'A√ß√£o bloqueada: analise o local primeiro.';
      return;
    }
    if (!phoneChecked) {
      appendLog('Voc√™ desbloqueia o smartphone de Noah e inicia a triangula√ß√£o via sat√©lite...');
      appendLog('Informa√ß√µes obtidas:');
      appendLog('- √Årea situada em um maci√ßo rochoso, distante da floresta original.');
      appendLog('- Ind√≠cios de rios subterr√¢neos ao leste; forma√ß√£o calc√°ria indicando poss√≠veis colapsos.');
      appendLog('- Apenas UMA sa√≠da conhecida na superf√≠cie, ao norte. A coordenada final requer resolver uma equa√ß√£o.');
      phoneChecked = true;
      statusDiv.textContent = 'Celular verificado com sucesso.';
    } else {
      appendLog('Voc√™ j√° verificou o celular anteriormente, sem novos dados.');
    }
  }

  function solvePuzzle() {
    if (!corridorsAnalyzed || !phoneChecked) {
      appendLog('Voc√™ precisa analisar os corredores e verificar o celular antes de resolver o enigma.');
      statusDiv.textContent = 'A√ß√£o bloqueada: conclua as etapas anteriores.';
      return;
    }
    if (!puzzleSolved) {
      appendLog(
        'Voc√™ cruza as informa√ß√µes de topografia e sat√©lite para descobrir o valor de X que leva √† sa√≠da.\n\n' +
        'Enigma:\n( X - 2.3 ) = 4.7\n' +
        'Calcule X e insira o resultado exato para confirmar a rota correta:'
      );
      const puzzleAnswer = prompt('Enigma:( X - 2.3 ) = 4.7 \nCalcule X e insira o resultado exato para confirmar a rota correta');
        

      if (puzzleAnswer) {
        const num = parseFloat(puzzleAnswer.trim());
        // (X - 2.3) = 4.7 => X = 4.7 + 2.3 => 7.0
        if (Math.abs(num - 7.0) < 0.0001) {
          appendLog('Enigma solucionado: X = 7.0. Indica que o corredor elevado e seco (D) leva √† sa√≠da ao norte.');
          puzzleSolved = true;
          statusDiv.textContent = 'Enigma resolvido. O corredor D parece ser a rota de fuga.';
        } else {
          appendLog('Resposta incorreta. Voc√™ n√£o conseguiu definir o corredor certo. Tente novamente.');
        }
      } else {
        appendLog('Voc√™ hesitou e n√£o digitou nenhuma resposta.');
      }
    } else {
      appendLog('O enigma j√° foi resolvido. Voc√™ sabe que o corredor D √© o caminho para a sa√≠da.');
    }
  }

  function choosePath() {
    if (!corridorsAnalyzed) {
      appendLog('Analise o ambiente antes de tomar uma decis√£o.');
      statusDiv.textContent = 'A√ß√£o bloqueada: examine o local.';
      return;
    }
    if (!phoneChecked) {
      appendLog('Verifique o celular antes de escolher sua rota.');
      statusDiv.textContent = 'A√ß√£o bloqueada: usar o celular primeiro.';
      return;
    }
    if (!puzzleSolved) {
      appendLog('Voc√™ deve resolver o enigma para identificar o corredor certo para escapar.');
      statusDiv.textContent = 'A√ß√£o bloqueada: resolva o enigma.';
      return;
    }
    if (corridorChoice) {
      appendLog('Voc√™ j√° fez sua escolha anteriormente.');
      return;
    }

    const choice = prompt('Escolha A, B, C ou D (digite a letra do corredor):', 'A/B/C/D');
    if (!choice) {
      appendLog('Voc√™ hesitou e n√£o selecionou nenhuma op√ß√£o.');
      return;
    }

    corridorChoice = true;
    const uppercaseChoice = choice.trim().toUpperCase();

    switch (uppercaseChoice) {
      case 'A':
        appendLog('Leon segue pelo Corredor A, onde um gotejamento indica um curso de √°gua abaixo...');
        endGame('Infelizmente, voc√™ atinge um labirinto alagado, sem sa√≠da clara. Fica preso nesse local.');
        break;
      case 'B':
        appendLog('Leon avan√ßa pelo Corredor B. O ar mofado e paredes rachadas sugerem risco de desabamento...');
        endGame('Ap√≥s explorar, encontra um beco sem sa√≠da. A fuga n√£o ocorre por aqui.');
        break;
      case 'C':
        appendLog('Leon investe no Corredor C, removendo algumas pedras. O som de ar sugeria esperan√ßa...');
        endGame('Atr√°s da barreira, h√° uma c√¢mara misteriosa mas sem sa√≠da para a superf√≠cie. Voc√™ fica encurralado.');
        break;
      case 'D':
        appendLog('Voc√™ escolhe o Corredor D, seco e com uma brisa morna. Comparado a X=7.0, parece ser o caminho elevado ao norte.');
        endGame('Uma longa caminhada revela feixes de luz e, finalmente, sua fuga para a superf√≠cie. Parab√©ns!');
        break;
      default:
        appendLog('Op√ß√£o inv√°lida. Voc√™ hesitou e n√£o escolheu corretamente.');
        corridorChoice = false; // Permite nova tentativa
    }
  }

  function endGame(message) {
    statusDiv.textContent = 'Decis√£o final tomada.';
    resultSection.style.display = 'block';
    finalText.textContent = message;
    // Desabilitar bot√µes para impedir novas a√ß√µes
    btnAnalyzeCorridors.disabled = true;
    btnCheckPhone.disabled = true;
    btnSolvePuzzle.disabled = true;
    btnChoosePath.disabled = true;
  }
</script>

